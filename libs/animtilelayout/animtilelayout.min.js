var eui;!function(t){var i=function(i){function e(){var e=i.call(this)||this;return e.explicitHorizontalGap=NaN,e._horizontalGap=6,e.explicitVerticalGap=NaN,e._verticalGap=6,e._columnCount=-1,e._requestedColumnCount=0,e._rowCount=-1,e._requestedRowCount=0,e.explicitColumnWidth=NaN,e._columnWidth=NaN,e.explicitRowHeight=NaN,e._rowHeight=NaN,e._paddingLeft=0,e._paddingRight=0,e._paddingTop=0,e._paddingBottom=0,e._horizontalAlign=t.JustifyAlign.JUSTIFY,e._verticalAlign=t.JustifyAlign.JUSTIFY,e._columnAlign=t.ColumnAlign.LEFT,e._rowAlign=t.RowAlign.TOP,e._orientation=t.TileOrientation.ROWS,e.maxElementWidth=0,e.maxElementHeight=0,e.startIndex=-1,e.endIndex=-1,e.indexInViewCalculated=!1,e}return __extends(e,i),Object.defineProperty(e.prototype,"horizontalGap",{get:function(){return this._horizontalGap},set:function(t){(t=+t)!==this._horizontalGap&&(this.explicitHorizontalGap=t,this._horizontalGap=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalGap",{get:function(){return this._verticalGap},set:function(t){(t=+t)!==this._verticalGap&&(this.explicitVerticalGap=t,this._verticalGap=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnCount",{get:function(){return this._columnCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requestedColumnCount",{get:function(){return this._requestedColumnCount},set:function(t){t=+t||0,this._requestedColumnCount!==t&&(this._requestedColumnCount=t,this._columnCount=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowCount",{get:function(){return this._rowCount},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"requestedRowCount",{get:function(){return this._requestedRowCount},set:function(t){t=+t||0,this._requestedRowCount!=t&&(this._requestedRowCount=t,this._rowCount=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnWidth",{get:function(){return this._columnWidth},set:function(t){(t=+t)!==this._columnWidth&&(this.explicitColumnWidth=t,this._columnWidth=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowHeight",{get:function(){return this._rowHeight},set:function(t){(t=+t)!==this._rowHeight&&(this.explicitRowHeight=t,this._rowHeight=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingLeft",{get:function(){return this._paddingLeft},set:function(t){t=+t||0,this._paddingLeft!=t&&(this._paddingLeft=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingRight",{get:function(){return this._paddingRight},set:function(t){t=+t||0,this._paddingRight!==t&&(this._paddingRight=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingTop",{get:function(){return this._paddingTop},set:function(t){t=+t||0,this._paddingTop!=t&&(this._paddingTop=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paddingBottom",{get:function(){return this._paddingBottom},set:function(t){t=+t||0,this._paddingBottom!==t&&(this._paddingBottom=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"horizontalAlign",{get:function(){return this._horizontalAlign},set:function(t){this._horizontalAlign!=t&&(this._horizontalAlign=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"verticalAlign",{get:function(){return this._verticalAlign},set:function(t){this._verticalAlign!=t&&(this._verticalAlign=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"columnAlign",{get:function(){return this._columnAlign},set:function(t){this._columnAlign!=t&&(this._columnAlign=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rowAlign",{get:function(){return this._rowAlign},set:function(t){this._rowAlign!=t&&(this._rowAlign=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"orientation",{get:function(){return this._orientation},set:function(t){this._orientation!=t&&(this._orientation=t,this.invalidateTargetLayout())},enumerable:!0,configurable:!0}),e.prototype.invalidateTargetLayout=function(){var t=this.$target;t&&(t.invalidateSize(),t.invalidateDisplayList())},e.prototype.measure=function(){var t=this.$target;if(t){var i=this._columnCount,e=this._rowCount,n=this._columnWidth,o=this._rowHeight,a=0,h=0,r=t.$UIComponent;this.calculateRowAndColumn(r[8],r[9]);var s=this._requestedColumnCount>0?this._requestedColumnCount:this._columnCount,u=this._requestedRowCount>0?this._requestedRowCount:this._rowCount,l=isNaN(this._horizontalGap)?0:this._horizontalGap,d=isNaN(this._verticalGap)?0:this._verticalGap;s>0&&(a=s*(this._columnWidth+l)-l),u>0&&(h=u*(this._rowHeight+d)-d);var c=this._paddingLeft+this._paddingRight,_=this._paddingTop+this._paddingBottom;t.setMeasuredSize(a+c,h+_),this._columnCount=i,this._rowCount=e,this._columnWidth=n,this._rowHeight=o}},e.prototype.calculateRowAndColumn=function(i,e){var n=this.$target,o=isNaN(this._horizontalGap)?0:this._horizontalGap,a=isNaN(this._verticalGap)?0:this._verticalGap;this._rowCount=this._columnCount=-1;for(var h=n.numElements,r=h,s=0;s<r;s++){var u=n.getElementAt(s);!u||egret.is(u,"eui.UIComponent")&&u.$includeInLayout||h--}if(0!=h){(isNaN(this.explicitColumnWidth)||isNaN(this.explicitRowHeight))&&this.updateMaxElementSize(),isNaN(this.explicitColumnWidth)?this._columnWidth=this.maxElementWidth:this._columnWidth=this.explicitColumnWidth,isNaN(this.explicitRowHeight)?this._rowHeight=this.maxElementHeight:this._rowHeight=this.explicitRowHeight;var l=this._columnWidth+o;l<=0&&(l=1);var d=this._rowHeight+a;d<=0&&(d=1);var c=this._orientation==t.TileOrientation.COLUMNS,_=!isNaN(i),g=!isNaN(e),p=this._paddingLeft,m=this._paddingRight,C=this._paddingTop,f=this._paddingBottom;if(this._requestedColumnCount>0||this._requestedRowCount>0)this._requestedRowCount>0&&(this._rowCount=Math.min(this._requestedRowCount,h)),this._requestedColumnCount>0&&(this._columnCount=Math.min(this._requestedColumnCount,h));else if(_||g)if(!_||g&&c){var x=Math.max(0,e-C-f);this._rowCount=Math.floor((x+a)/d),this._rowCount=Math.max(1,Math.min(this._rowCount,h))}else{var y=Math.max(0,i-p-m);this._columnCount=Math.floor((y+o)/l),this._columnCount=Math.max(1,Math.min(this._columnCount,h))}else{var w=Math.sqrt(h*l*d);c?this._rowCount=Math.max(1,Math.round(w/d)):this._columnCount=Math.max(1,Math.round(w/l))}-1==this._rowCount&&(this._rowCount=Math.max(1,Math.ceil(h/this._columnCount))),-1==this._columnCount&&(this._columnCount=Math.max(1,Math.ceil(h/this._rowCount))),this._requestedColumnCount>0&&this._requestedRowCount>0&&(this._orientation==t.TileOrientation.ROWS?this._rowCount=Math.max(1,Math.ceil(h/this._requestedColumnCount)):this._columnCount=Math.max(1,Math.ceil(h/this._requestedRowCount)))}else this._rowCount=this._columnCount=0},e.prototype.updateMaxElementSize=function(){this.$target&&(this.$useVirtualLayout?(this.maxElementWidth=Math.max(this.maxElementWidth,this.$typicalWidth),this.maxElementHeight=Math.max(this.maxElementHeight,this.$typicalHeight),this.doUpdateMaxElementSize(this.startIndex,this.endIndex)):this.doUpdateMaxElementSize(0,this.$target.numElements-1))},e.prototype.doUpdateMaxElementSize=function(t,i){var e=this.maxElementWidth,n=this.maxElementHeight,o=egret.$TempRectangle,a=this.$target;if(-1!=t&&-1!=i)for(var h=t;h<=i;h++){var r=a.getVirtualElementAt(h);egret.is(r,"eui.UIComponent")&&r.$includeInLayout&&(r.getPreferredBounds(o),e=Math.max(e,o.width),n=Math.max(n,o.height))}this.maxElementWidth=e,this.maxElementHeight=n},e.prototype.clearVirtualLayoutCache=function(){i.prototype.clearVirtualLayoutCache.call(this),this.maxElementWidth=0,this.maxElementHeight=0},e.prototype.scrollPositionChanged=function(){this.$useVirtualLayout&&(this.getIndexInView()&&(this.indexInViewCalculated=!0,this.$target.invalidateDisplayList()))},e.prototype.getIndexInView=function(){if(!this.$target||0==this.$target.numElements)return this.startIndex=this.endIndex=-1,!1;var i=this.$target,e=i.numElements;if(!this.$useVirtualLayout)return this.startIndex=0,this.endIndex=e-1,!1;var n=i.$UIComponent;if(0==n[10]||0==n[11])return this.startIndex=this.endIndex=-1,!1;var o=this.startIndex,a=this.endIndex,h=this._paddingLeft,r=this._paddingTop,s=isNaN(this._horizontalGap)?0:this._horizontalGap,u=isNaN(this._verticalGap)?0:this._verticalGap;if(this._orientation==t.TileOrientation.COLUMNS){var l=this._columnWidth+s;if(l<=0)return this.startIndex=0,this.endIndex=e-1,!1;var d=i.scrollH,c=d+n[10],_=Math.floor((d-h)/l);_<0&&(_=0);var g=Math.ceil((c-h)/l);g<0&&(g=0),this.startIndex=Math.min(e-1,Math.max(0,_*this._rowCount)),this.endIndex=Math.min(e-1,Math.max(0,g*this._rowCount-1))}else{var p=this._rowHeight+u;if(p<=0)return this.startIndex=0,this.endIndex=e-1,!1;var m=i.scrollV,C=m+n[11],f=Math.floor((m-r)/p);f<0&&(f=0);var x=Math.ceil((C-r)/p);x<0&&(x=0),this.startIndex=Math.min(e-1,Math.max(0,f*this._columnCount)),this.endIndex=Math.min(e-1,Math.max(0,x*this._columnCount-1))}return this.startIndex!=o||this.endIndex!=a},e.prototype.updateDisplayList=function(e,n){if(i.prototype.updateDisplayList.call(this,e,n),this.$target){var o=this.$target,a=this._paddingLeft,h=this._paddingRight,r=this._paddingTop,s=this._paddingBottom;if(this.indexInViewCalculated)this.indexInViewCalculated=!1;else{if(this.calculateRowAndColumn(e,n),0==this._rowCount||0==this._columnCount)return void o.setContentSize(a+h,r+s);this.adjustForJustify(e,n),this.getIndexInView()}if(this.$useVirtualLayout&&(this.calculateRowAndColumn(e,n),this.adjustForJustify(e,n)),-1!=this.startIndex&&-1!=this.endIndex){var u,l,d,c,_,g=Math.max(this.startIndex-(1|this.requestedColumnCount),0),p=this.endIndex+(1|this.requestedColumnCount);o.setVirtualElementIndicesInView(g,p);for(var m=this._orientation==t.TileOrientation.COLUMNS,C=g,f=isNaN(this._horizontalGap)?0:this._horizontalGap,x=isNaN(this._verticalGap)?0:this._verticalGap,y=this._rowCount,w=this._columnCount,v=this._columnWidth,I=this._rowHeight,M=g;M<=p;M++)if(u=this.$useVirtualLayout?this.target.getVirtualElementAt(M):this.target.getElementAt(M),egret.is(u,"eui.UIComponent")&&u.$includeInLayout){switch(m?(c=Math.ceil((C+1)/y)-1,-1==(_=Math.ceil((C+1)%y)-1)&&(_=y-1)):(-1==(c=Math.ceil((C+1)%w)-1)&&(c=w-1),_=Math.ceil((C+1)/w)-1),this._horizontalAlign){case egret.HorizontalAlign.RIGHT:l=e-(c+1)*(v+f)+f-h;break;case egret.HorizontalAlign.LEFT:l=c*(v+f)+a;break;default:l=c*(v+f)+a}switch(this._verticalAlign){case egret.VerticalAlign.TOP:d=_*(I+x)+r;break;case egret.VerticalAlign.BOTTOM:d=n-(_+1)*(I+x)+x-s;break;default:d=_*(I+x)+r}this.sizeAndPositionElement(u,l,d,v,I),C++}var N=a+h,A=r+s,b=(v+f)*w-f,T=(I+x)*y-x;o.setContentSize(b+N,T+A)}else o.setContentSize(0,0)}},e.prototype.sizeAndPositionElement=function(i,e,n,o,a){var h=NaN,r=NaN,s=i.$UIComponent;this._horizontalAlign==t.JustifyAlign.JUSTIFY?h=o:isNaN(s[6])||(h=o*s[6]*.01),this._verticalAlign==t.JustifyAlign.JUSTIFY?r=a:isNaN(s[7])||(r=a*s[7]*.01),i.setLayoutBoundsSize(Math.round(h),Math.round(r));var u=e,l=egret.$TempRectangle;switch(i.getLayoutBounds(l),this._horizontalAlign){case egret.HorizontalAlign.RIGHT:u+=o-l.width;break;case egret.HorizontalAlign.CENTER:u=e+(o-l.width)/2}var d=n;switch(this._verticalAlign){case egret.VerticalAlign.BOTTOM:d+=a-l.height;break;case egret.VerticalAlign.MIDDLE:d+=(a-l.height)/2}i.setLayoutBoundsPosition(Math.round(u),Math.round(d))},e.prototype.adjustForJustify=function(i,e){var n=this._paddingLeft,o=this._paddingRight,a=this._paddingTop,h=this._paddingBottom,r=Math.max(0,i-n-o),s=Math.max(0,e-a-h);isNaN(this.explicitVerticalGap)||(this._verticalGap=this.explicitVerticalGap),isNaN(this.explicitHorizontalGap)||(this._horizontalGap=this.explicitHorizontalGap),this._verticalGap=isNaN(this._verticalGap)?0:this._verticalGap,this._horizontalGap=isNaN(this._horizontalGap)?0:this._horizontalGap;var u,l=s-this._rowHeight*this._rowCount,d=r-this._columnWidth*this._columnCount;l>0&&(this._rowAlign==t.RowAlign.JUSTIFY_USING_GAP?(u=Math.max(1,this._rowCount-1),this._verticalGap=l/u):this._rowAlign==t.RowAlign.JUSTIFY_USING_HEIGHT&&this._rowCount>0&&(this._rowHeight+=(l-(this._rowCount-1)*this._verticalGap)/this._rowCount)),d>0&&(this._columnAlign==t.ColumnAlign.JUSTIFY_USING_GAP?(u=Math.max(1,this._columnCount-1),this._horizontalGap=d/u):this._columnAlign==t.ColumnAlign.JUSTIFY_USING_WIDTH&&this._columnCount>0&&(this._columnWidth+=(d-(this._columnCount-1)*this._horizontalGap)/this._columnCount))},e}(t.LayoutBase);t.AnimTileLayout=i,__reflect(i.prototype,"eui.AnimTileLayout")}(eui||(eui={}));
