var egret;!function(t){!function(e){var i=i||0,a=function(e){function a(i,a){void 0===a&&(a=!0);var s=e.call(this)||this;return s.heightSet=NaN,s.widthSet=NaN,s.userPause=!1,s.userPlay=!1,s.isPlayed=!1,s.$renderNode=new t.sys.BitmapNode,s.once(t.Event.ADDED_TO_STAGE,s.loadPoster,s),i&&s.load(),s}return __extends(a,e),a.prototype.createNativeDisplayObject=function(){this.$nativeDisplayObject=new egret_native.NativeDisplayObject(1)},a.prototype.load=function(e,a){if(void 0===a&&(a=!0),e||t.$error(3002),this.src!=e){var s;this.src=e;var r="videoCanvas"+i++;this.videoCanvas||((s=document.createElement("canvas")).id=r,s.width=640,s.height=360,s.style.display="none",this.videoCanvas=s,document.body.appendChild(s));var o=new WFPlayer;WFPlayer.debug(!1),o.enableAudio(!0),o.setView(r),o.setScaleMode(1),o.setBufferTime(1e3),this.startFunc1=function(){o.stop(),setTimeout(()=>{o.start(e),t.startTick(this.markDirty,this)},500)},this.stopFunc1=function(){o.stop(),t.stopTick(this.markDirty,this)}}},a.prototype.play=function(){this.userPause=!1,this.userPlay=!0,this.isPlayed=!0,this.startFunc1()},a.prototype.stop=function(){this.userPause=!0,this.userPlay=!1,this.stopFunc1()},a.prototype.reset=function(){this.stop()},Object.defineProperty(a.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(t){this.video&&(this.video.volume=t)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"canvasElement",{get:function(){return this.videoCanvas?this.videoCanvas:null},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"bitmapData",{get:function(){return this.isPlayed?(this._bitmapData||(this._bitmapData=new t.BitmapData(this.videoCanvas),this._bitmapData.$deleteSource=!1),this._bitmapData):null},enumerable:!0,configurable:!0}),a.prototype.loadPoster=function(){var e=this,i=this.poster;if(i){var a=new t.ImageLoader;a.once(t.Event.COMPLETE,function(i){a.data;if(e.posterData=a.data,e.$renderDirty=!0,e.posterData.width=e.getPlayWidth(),e.posterData.height=e.getPlayHeight(),t.nativeRender){var s=new t.Texture;s._setBitmapData(e.posterData),e.$nativeDisplayObject.setTexture(s)}},this),a.load(i)}},a.prototype.$measureContentBounds=function(t){var e=this.bitmapData,i=this.posterData;e?t.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):i?t.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):t.setEmpty()},a.prototype.getPlayWidth=function(){return isNaN(this.widthSet)?this.bitmapData?this.bitmapData.width:this.posterData?this.posterData.width:NaN:this.widthSet},a.prototype.getPlayHeight=function(){return isNaN(this.heightSet)?this.bitmapData?this.bitmapData.height:this.posterData?this.posterData.height:NaN:this.heightSet},a.prototype.$updateRenderNode=function(){var e=this.$renderNode,i=this.bitmapData,a=this.posterData,s=this.getPlayWidth(),r=this.getPlayHeight();this.isPlayed&&i?i&&(e.image=i,e.imageWidth=i.width,e.imageHeight=i.height,t.WebGLUtils.deleteWebGLTexture(i.webGLTexture),i.webGLTexture=null,e.drawImage(0,0,i.width,i.height,0,0,s,r)):(e.image=a,e.imageWidth=s,e.imageHeight=r,e.drawImage(0,0,a.width,a.height,0,0,s,r))},a.prototype.markDirty=function(){return this.$renderDirty=!0,!0},a.prototype.$setHeight=function(t){if(this.heightSet=t,this.userPause){var i=this;this.$renderDirty=!0,window.setTimeout(function(){i.$renderDirty=!1},200)}e.prototype.$setHeight.call(this,t)},a.prototype.$setWidth=function(t){if(this.widthSet=t,this.userPause){var i=this;this.$renderDirty=!0,window.setTimeout(function(){i.$renderDirty=!1},200)}e.prototype.$setWidth.call(this,t)},Object.defineProperty(a.prototype,"paused",{get:function(){return this.userPause},enumerable:!0,configurable:!0}),a.$videoIndex=a.$videoIndex||0,a}(t.DisplayObject);e.WebFlvVideo=a,__reflect(a.prototype,"egret.web.WebFlvVideo",["egret.FlvVideo","egret.DisplayObject"]),t.FlvVideo=a}(t.web||(t.web={}))}(egret||(egret={}));
